<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- SEO and Meta Tags - UPDATED -->
    <title>Free Fire Free Diamond ‚Äî Legit Tips, Tricks & Safe Methods</title>
    <meta name="description" content="Discover safe ways to get Free Fire free diamond. Learn legit tips, avoid fake free fire diamond hack scams, and follow simple tricks to earn diamonds safely.">
    <meta name="keywords" content="Free fire free diamond, Free fire diamond hack, free fire free diamond trick, free fire diamonds">
    <link rel="canonical" href="https://example.com/free-fire-diamonds.html">
    <meta property="og:title" content="Free Fire Free Diamond ‚Äî Legit Tips, Tricks & Safe Methods">
    <meta property="og:description" content="Discover safe ways to get Free Fire free diamond. Learn legit tips, avoid fake free fire diamond hack scams, and follow simple tricks to earn diamonds safely.">
    <meta property="og:image" content="https://example.com/og-free-fire-diamonds.jpg">
    <meta property="og:url" content="https://example.com/free-fire-diamonds.html">
    <meta property="og:type" content="article">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Fire Free Diamond ‚Äî Legit Tips & Tricks">
    <meta name="twitter:description" content="Learn how to get Free Fire free diamond safely, what tricks are real, and why Free fire diamond hack offers are dangerous.">
    <meta name="twitter:image" content="https://example.com/og-free-fire-diamonds.jpg">

    <!-- Favicon Link Added -->
    <link rel="icon" type="image/png" href="favicon.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    
    <style>
        :root {
            --primary-color: #008080;
            --light-grey: #f0f2f5;
            --border-color: #e9e9e9;
            --text-color: #333;
            --text-light: #777;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --success-color: #28a745;
            --pending-color: #ffc107;
            --danger-color: #dc3545;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--light-grey); color: var(--text-color); padding: 1.5rem 1rem; }
        .app-container { 
            width: 100%; 
            max-width: 420px; 
            margin: 0 auto;
            position: relative; /* Needed for menu positioning */
        }
        .main-title { font-size: 1.5rem; font-weight: 700; text-align: center; margin-bottom: 0.5rem; }
        .sub-title { text-align: center; color: var(--text-light); font-weight: 500; margin-bottom: 2rem; }
        .card { background: #ffffff; border-radius: 16px; box-shadow: var(--card-shadow); margin-bottom: 1.5rem; }
        .card-header { padding: 1rem 1.25rem; font-size: 1.1rem; font-weight: 500; display: flex; align-items: center; gap: 0.75rem; }
        .card-header .icon { width: 28px; height: 28px; background-color: var(--primary-color); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: 700; }
        .card-body { padding: 0.5rem 1.25rem 1.25rem; }
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem; color: #555; }
        .form-control, .form-select { width: 100%; padding: 0.8rem 1rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; background-color: #f8f9fa; transition: border-color 0.3s; }
        .form-control:focus, .form-select:focus { border-color: var(--primary-color); outline: none; }
        .form-select { appearance: none; -webkit-appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23333333' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 16px 12px; }
        .btn-topup { width: 100%; padding: 1rem; font-size: 1.1rem; font-weight: 700; color: white; background: var(--primary-color); border: none; border-radius: 12px; cursor: pointer; transition: background 0.3s; }
        .btn-topup:disabled { background: #b0b0b0; cursor: not-allowed; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .diamond-option { background-color: #fff; border: 1px solid var(--border-color); padding: 0.9rem 0.5rem; border-radius: 8px; cursor: pointer; text-align: center; font-weight: 500; font-size: 0.9rem; color: #555; transition: all 0.2s; }
        .diamond-option.selected { border-color: var(--primary-color); background-color: #e6f2f2; color: var(--primary-color); font-weight: 700; }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 1000; display: none; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s; }
        .modal-overlay.show { display: flex; opacity: 1; }
        .modal-content { background: #fff; padding: 2rem; border-radius: 12px; width: 90%; max-width: 360px; text-align: center; }
        .btn-ad { width: 100%; padding: 0.8rem; border-radius: 10px; border: 1px solid var(--primary-color); color: var(--primary-color); background: transparent; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-ad.watched { background: var(--success-color); border-color: var(--success-color); color: #fff; }
        .btn-cancel { width: 100%; padding: 0.8rem; border-radius: 10px; border: 1px solid var(--danger-color); color: var(--danger-color); background: transparent; font-weight: 600; cursor: pointer; margin-top: 1rem; }
        
        .history-list, .live-topup-list { list-style: none; padding: 0; }
        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem 0; font-size: 0.9rem; border-bottom: 1px solid #f0f0f0; }
        .list-item:last-child { border-bottom: none; }
        .status-badge { padding: 0.2rem 0.7rem; border-radius: 20px; font-size: 0.75rem; font-weight: 500; color: white; }
        .status-badge.success { background-color: var(--success-color); }
        .status-badge.pending { background-color: var(--pending-color); color: #333; }
        .btn-speed-up { background: #f0f0f0; color: #555; border: none; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer; font-size: 0.75rem; font-weight: 500; margin-top: 0.5rem; }
        .btn-speed-up:disabled { opacity: 0.5; cursor: not-allowed; }

        .spinner-border { width: 1.2rem; height: 1.2rem; border: 0.2em solid currentColor; border-right-color: transparent; border-radius: 50%; animation: spinner-border .75s linear infinite; } @keyframes spinner-border { to { transform: rotate(360deg); } }
        .d-none { display: none !important; }
        #success-toast { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); background-color: #333; color: white; padding: 1rem 1.5rem; border-radius: 8px; z-index: 1002; font-weight: 500; transition: bottom 0.5s; }
        #success-toast.show { bottom: 20px; }

        #infoIcon { transition: transform 0.3s ease; }
        .info-card .card-body { 
            display: none;
            padding: 0.5rem 1.25rem 1.25rem;
            line-height: 1.6;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        #menu-trigger {
            position: absolute;
            top: 0.5rem;
            right: 0rem;
            font-size: 1.4rem;
            color: var(--text-light);
            cursor: pointer;
            z-index: 10;
            padding: 0.5rem;
            transition: color 0.3s;
        }
        #menu-trigger:hover {
            color: var(--primary-color);
        }
        #menu-modal {
            align-items: flex-start;
            justify-content: flex-end;
        }
        .menu-content {
            background: #fff;
            border-radius: 12px;
            width: 200px;
            margin-top: 3.5rem;
            margin-right: 1rem;
            border: 1px solid var(--border-color);
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        .menu-content a {
            display: block;
            padding: 1rem 1.25rem;
            color: var(--text-color);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
        }
        .menu-content a:hover {
            background-color: #f8f9fa;
        }
        .menu-content a:last-child {
            border-bottom: none;
        }
        
        /* Styles for new content sections */
        .content-section .card-body h1, .content-section .card-body h2, .content-section .card-body h3 {
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-color);
        }
        .content-section .card-body h1 { font-size: 1.4rem; }
        .content-section .card-body h2 { font-size: 1.2rem; }
        .content-section .card-body h3 { font-size: 1.1rem; color: var(--primary-color); }
        .content-section .card-body p { line-height: 1.6; color: var(--text-light); margin-bottom: 1rem; }
        .content-section .card-body ol, .content-section .card-body ul { padding-left: 20px; margin-bottom: 1rem; color: var(--text-light); }
        .content-section .card-body li { margin-bottom: 0.75rem; }
        .content-section .card-body strong, .content-section .card-body em { color: var(--text-color); }

        .faq-item {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
    </style>

    <!-- FAQ JSON-LD Schema - ADDED -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Can I really get Free Fire free diamond?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes ‚Äî but only via official events, achievements, giveaways, or trusted reward apps. Avoid so-called hacks or generators that promise unlimited diamonds."
          }
        },
        {
          "@type": "Question",
          "name": "Do free fire diamond hack sites work?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Most are scams. They often steal accounts or install malware. Do not enter your password or personal data on unknown sites."
          }
        },
        {
          "@type": "Question",
          "name": "What is a safe trick to get diamonds?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Participate in in-game events, claim season rewards, use legit reward apps (e.g., Google Opinion Rewards), and join official giveaways."
          }
        },
        {
          "@type": "Question",
          "name": "Is this website providing unlimited gems hack?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "No. We provide guidance and demo flows only. We do not support any illegal hacks or account compromises."
          }
        }
      ]
    }
    </script>
</head>
<body>
    <div class="app-container">
        <div id="menu-trigger" title="Menu">
            <i class="fa-solid fa-ellipsis-vertical"></i>
        </div>

        <h2 class="main-title">Free Fire Diamond Top-up</h2>
        <p class="sub-title">Free Fire (ID CODE)</p>
        
        <div id="topup-section" class="content-section">
            <div class="card info-card" id="infoCard">
                <div class="card-header" id="infoCardHeader" style="cursor: pointer; padding-bottom: 1rem;">
                    <div class="icon" style="background: transparent; color: var(--primary-color); font-weight: 400;"><i class="fa-solid fa-circle-question"></i></div>
                    <span>How to find your Player ID?</span>
                    <i class="fa-solid fa-chevron-down" id="infoIcon" style="margin-left: auto; color: var(--text-light);"></i>
                </div>
                <div class="card-body" id="infoCardBody">
                    <p>
                        1. Open Free Fire on your device.<br>
                        2. Go to your profile in the top-left corner.<br>
                        3. Your Player ID is the number shown under your nickname.
                    </p>
                </div>
            </div>

            <form id="topupForm" onsubmit="return false;">
                <div class="card">
                    <div class="card-header"><div class="icon">I</div><span>Account Info</span></div>
                    <div class="card-body">
                        <label for="playerUid" class="form-label">Player ID</label>
                        <input type="number" class="form-control" id="playerUid" placeholder="Enter player id" required>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header"><div class="icon">R</div><span>Select Recharge</span></div>
                    <div class="card-body">
                         <div id="diamondOptionsGrid" class="options-grid">
                            <p style="grid-column: span 2; text-align: center; color: var(--text-light);">Please select a country first.</p>
                         </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="countrySelect" class="form-label">Country</label>
                    <select class="form-select" id="countrySelect" required>
                        <option value="" selected disabled>Select Country</option>
                    </select>
                </div>

                <button type="button" class="btn-topup" id="topupButton" disabled>
                    <span id="btnText">Top-up Now</span>
                </button>
            </form>

            <div class="card" id="historyCard" style="display: none; margin-top: 2rem;">
                <div class="card-header"><div class="icon">H</div><span>Your History</span></div>
                <div class="card-body"><div id="historyList" class="history-list"></div></div>
            </div>

            <div class="card" id="liveTopupCard" style="margin-top: 2rem;">
                <div class="card-header"><div class="icon">L</div><span>Recent Top-ups</span></div>
                <div class="card-body" style="padding-top: 0.5rem; padding-bottom: 0.5rem;"><div id="liveTopupList" class="live-topup-list"></div></div>
            </div>
        </div>

        <!-- HOW TO USE SECTION - UPDATED -->
        <div id="how-to-use-section" class="content-section" style="display: none;">
             <div class="card">
                <div class="card-header"><div class="icon"><i class="fa-solid fa-question"></i></div><span>How To Use</span></div>
                <div class="card-body">
                    <section id="how-to-use">
                       <h2>How to Use This Free Fire Diamond Tool (Demo)</h2>
                       <p>Follow these simple steps. This tool is for demo/learning only ‚Äî it does not provide illegal hacks.</p>
                       <ol>
                         <li><strong>Select your country:</strong> Choose the country from the dropdown so the right diamond packs appear.</li>
                         <li><strong>Enter your Player ID:</strong> Open Free Fire ‚Üí profile ‚Üí copy your Player ID and paste it into the Player ID field.</li>
                         <li><strong>Choose a diamond pack:</strong> Tap a pack (e.g., 100 Diamonds) ‚Äî the selected option highlights.</li>
                         <li><strong>Click ‚ÄúTop-up Now‚Äù: </strong> A verification dialog will appear asking you to complete safe steps (watch ad/demo). Follow the on-screen instructions.</li>
                         <li><strong>Wait for confirmation:</strong> After completing steps your request will appear in ‚ÄúYour History‚Äù as Pending. This demo shows how top-up flow works ‚Äî real diamonds are not guaranteed.</li>
                       </ol>
                       <p style="color:#b33;">Important: Avoid any external sites that ask for your password, Google Play credentials, or private keys. Those are scams.</p>
                    </section>
                </div>
            </div>
        </div>

        <!-- BLOG SECTION - ADDED -->
        <div id="blog-section" class="content-section" style="display: none;">
            <div class="card">
               <div class="card-header"><div class="icon"><i class="fa-solid fa-newspaper"></i></div><span>Blog</span></div>
               <div class="card-body">
                   <section id="free-fire-blog">
                       <h1>How to Get Free Fire Free Diamond ‚Äî Real Tips & Safe Tricks</h1>
                       <p>
                         Many players search for ways to get <strong>Free Fire free diamond</strong> without spending real money.
                         You may find websites that promise an instant <em>free fire diamond hack</em> or a magical <em>free fire free diamond trick</em>.
                         The harsh truth is most of those are scams, and they can risk your account or device.
                       </p>
                       <p>
                         Below you‚Äôll find legitimate, safe and practical methods to earn diamonds, plus clear warnings about hacks and generators.
                         Follow the trusted steps, be patient, and avoid shortcuts that look too good to be true.
                       </p>
                       <h2>Legit Ways to Earn Free Fire Diamonds</h2>
                       <ol>
                         <li>
                           <strong>Official Events & Giveaways:</strong>
                           Attend in-game events, seasonal campaigns and Supercell promotions. Events sometimes reward diamonds directly or give tickets that can be converted.
                         </li>
                         <li>
                           <strong>Ranked Rewards & Achievements:</strong>
                           Climb ranked seasons, complete milestones and achievements‚Äîthose sometimes grant small diamond rewards or resources that help reduce spending.
                         </li>
                         <li>
                           <strong>Third-Party Reward Apps (trusted):</strong>
                           Use reputable reward apps like Google Opinion Rewards or official gift card promotions that let you earn credit to buy diamonds.
                         </li>
                         <li>
                           <strong>Live Streams & Creator Codes:</strong>
                           Follow official creators, watch live streams with partnered giveaways, and participate in community events where diamonds are given away.
                         </li>
                       </ol>
                       <h2>Why ‚ÄúFree Fire Diamond Hack‚Äù Claims Are Dangerous</h2>
                       <p>
                         Websites or apps that advertise an <strong>unlimited free fire diamond hack</strong> usually want your account login, device data or direct payment.
                         Using such hacks can lead to account bans, theft of login details, or malware on your phone.
                         Always prioritize account safety over a quick diamond gain.
                       </p>
                       <h2>Quick Tips ‚Äî Practical Tricks That Work</h2>
                       <ul>
                         <li>Keep an eye on official Free Fire social channels for giveaways.</li>
                         <li>Participate in community contests (Discord, Facebook gaming groups).</li>
                         <li>Use secure payment methods and never share your password.</li>
                         <li>Check multiple legit sources before trying any ‚Äútrick‚Äù.</li>
                       </ul>
                       <p>
                         If you want, use our demo top-up tool responsibly for learning how the flow works ‚Äî remember: this site does <em>not</em> support real hacks or account compromises.
                       </p>
                   </section>
               </div>
           </div>
        </div>

        <!-- FAQ SECTION - ADDED -->
        <div id="faq-section" class="content-section" style="display: none;">
            <div class="card">
               <div class="card-header"><div class="icon"><i class="fa-solid fa-question-circle"></i></div><span>FAQ</span></div>
               <div class="card-body">
                    <section id="faq">
                       <h2>Frequently Asked Questions (FAQ)</h2>
                       <div class="faq-item">
                         <h3>Q: Can I really get Free Fire free diamond?</h3>
                         <p>A: Yes ‚Äî but only via official events, achievements, giveaways, or trusted reward apps. Avoid so-called hacks or generators that promise unlimited diamonds.</p>
                       </div>
                       <div class="faq-item">
                         <h3>Q: Do free fire diamond hack sites work?</h3>
                         <p>A: Most are scams. They often steal accounts or install malware. Do not enter your password or personal data on unknown sites.</p>
                       </div>
                       <div class="faq-item">
                         <h3>Q: What is a safe trick to get diamonds?</h3>
                         <p>A: Participate in in-game events, claim season rewards, use legit reward apps (e.g., Google Opinion Rewards), and join official giveaways.</p>
                       </div>
                       <div class="faq-item">
                         <h3>Q: Is this website providing unlimited gems hack?</h3>
                         <p>A: No. We provide guidance and demo flows only. We do not support any illegal hacks or account compromises.</p>
                       </div>
                    </section>
               </div>
           </div>
        </div>
    </div>
    
    <div id="adModal" class="modal-overlay">
        <div class="modal-content" id="modalContent"></div>
    </div>
    <div id="success-toast"></div>
    
    <div id="menu-modal" class="modal-overlay">
        <div class="menu-content">
            <a href="#" class="menu-link" data-target="topup-section">Home</a>
            <a href="#" class="menu-link" data-target="how-to-use-section">How to Use</a>
            <a href="#" class="menu-link" data-target="blog-section">Blog</a>
            <a href="#" class="menu-link" data-target="faq-section">FAQ</a>
            <a href="#" class="menu-link" data-target="about-us-section">About Us</a>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const DIRECT_LINK_URL = 'https://bracecherry.com/u6a337e7?key=3325650cf041e83fe4b4f2c8585e55e2'; 
    const countrySelect = document.getElementById('countrySelect');
    const playerUidInput = document.getElementById('playerUid');
    const diamondGrid = document.getElementById('diamondOptionsGrid');
    const topupButton = document.getElementById('topupButton');
    const historyCard = document.getElementById('historyCard');
    const historyList = document.getElementById('historyList');
    const adModal = document.getElementById('adModal');
    const modalContent = document.getElementById('modalContent');
    const infoCardHeader = document.getElementById('infoCardHeader');
    const infoCardBody = document.getElementById('infoCardBody');
    const infoIcon = document.getElementById('infoIcon');
    const menuTrigger = document.getElementById('menu-trigger');
    const menuModal = document.getElementById('menu-modal');
    
    let selectedDiamondIndex = null;
    let activeTimerInterval = null;

    const gameData = {
        'Bangladesh': { 
            emoji: 'üáßüá©',
            diamonds: [ 
                { text: '25 Diamonds', value: 25, ads: 1 }, { text: '50 Diamonds', value: 50, ads: 1 },
                { text: '115 Diamonds', value: 115, ads: 1 }, { text: '240 Diamonds', value: 240, ads: 1 },
                { text: '610 Diamonds', value: 610, ads: 1 }, { text: '1240 Diamonds', value: 1240, ads: 2 }, 
                { text: '2530 Diamonds', value: 2530, ads: 2 }, { text: '5190 Diamonds', value: 5190, ads: 2 },
                { text: 'Weekly Lite', value: 'Weekly Lite', ads: 1 }, { text: 'Weekly', value: 'Weekly', ads: 2},
                { text: 'Monthly', value: 'Monthly', ads: 2}
            ], 
            validation: /^\d{8,12}$/ 
        },
        'India': { 
            emoji: 'üáÆüá≥',
            diamonds: [ 
                { text: '100 Diamonds', value: 100, ads: 1 }, { text: '210 Diamonds', value: 210, ads: 1 },
                { text: '310 Diamonds', value: 310, ads: 1 }, { text: '520 Diamonds', value: 520, ads: 1 }, 
                { text: '1060 Diamonds', value: 1060, ads: 2 }, { text: '2180 Diamonds', value: 2180, ads: 2 },
                { text: '5600 Diamonds', value: 5600, ads: 2 }
            ], 
            validation: /^\d{8,12}$/ 
        },
        'Pakistan': { 
            emoji: 'üáµüá∞',
            diamonds: [ 
                { text: '100 Diamonds', value: 100, ads: 1 }, { text: '310 Diamonds', value: 310, ads: 1 },
                { text: '520 Diamonds', value: 520, ads: 1 }, { text: '1060 Diamonds', value: 1060, ads: 2 },
                { text: '2180 Diamonds', value: 2180, ads: 2 }, { text: 'Weekly', value: 'Weekly', ads: 1 },
                { text: 'Monthly', value: 'Monthly', ads: 2 }
            ], 
            validation: /^\d{8,12}$/ 
        },
        'Nepal': { 
            emoji: 'üá≥üáµ',
            diamonds: [ 
                { text: '100 Diamonds', value: 100, ads: 1 }, { text: '310 Diamonds', value: 310, ads: 1 },
                { text: '520 Diamonds', value: 520, ads: 1 }, { text: '1060 Diamonds', value: 1060, ads: 2 },
                { text: '2180 Diamonds', value: 2180, ads: 2 }, { text: 'Weekly', value: 'Weekly', ads: 1 },
                { text: 'Monthly', value: 'Monthly', ads: 2 }
            ], 
            validation: /^\d{8,12}$/ 
        },
        'Indonesia': { 
            emoji: 'üáÆüá©',
            diamonds: [ 
                { text: '70 Diamonds', value: 70, ads: 1 }, { text: '140 Diamonds', value: 140, ads: 1 },
                { text: '355 Diamonds', value: 355, ads: 1 }, { text: '720 Diamonds', value: 720, ads: 2 },
                { text: '1440 Diamonds', value: 1440, ads: 2 }, { text: 'Weekly', value: 'Weekly', ads: 1 },
                { text: 'Monthly', value: 'Monthly', ads: 2 }
            ], 
            validation: /^\d{8,12}$/ 
        },
        'Malaysia': { 
            emoji: 'üá≤üáæ',
            diamonds: [ 
                { text: '70 Diamonds', value: 70, ads: 1 }, { text: '140 Diamonds', value: 140, ads: 1 },
                { text: '355 Diamonds', value: 355, ads: 1 }, { text: '720 Diamonds', value: 720, ads: 2 },
                { text: '1440 Diamonds', value: 1440, ads: 2 }, { text: 'Weekly', value: 'Weekly', ads: 1 },
                { text: 'Monthly', value: 'Monthly', ads: 2 }
            ], 
            validation: /^\d{8,12}$/ 
        }
    };
    
    function populateCountries() {
        for (const country in gameData) {
            const option = document.createElement('option');
            option.value = country;
            option.textContent = `${gameData[country].emoji} ${country}`;
            countrySelect.appendChild(option);
        }
    }

    function populateDiamonds(packages) {
        diamondGrid.innerHTML = '';
        selectedDiamondIndex = null;
        if (!packages) {
             diamondGrid.innerHTML = '<p style="grid-column: span 2; text-align: center; color: var(--text-light);">Please select a country first.</p>';
             return;
        }
        packages.forEach((pkg, index) => {
            const button = document.createElement('button');
            button.type = 'button';
            button.className = 'diamond-option';
            button.textContent = pkg.text;
            button.dataset.index = index;
            button.addEventListener('click', () => {
                const currentSelected = diamondGrid.querySelector('.selected');
                if (currentSelected) currentSelected.classList.remove('selected');
                button.classList.add('selected');
                selectedDiamondIndex = index;
                validateForm();
            });
            diamondGrid.appendChild(button);
        });
    }

    function showVerificationModal() {
        const selectedCountry = countrySelect.value;
        const diamondData = gameData[selectedCountry].diamonds[selectedDiamondIndex];
        let adsWatched = 0;
        
        modalContent.innerHTML = `
            <h3>Verification Required</h3>
            <p style="margin: 1rem 0; color: var(--text-light);">To continue, please complete ${diamondData.ads} steps. You must wait 10 seconds on the opened page.</p>
            <div id="adButtonsContainer" style="display: flex; flex-direction: column; gap: 1rem; width: 100%;"></div>
            <button class="btn-cancel" id="cancelAdProcess">Cancel Process</button>
        `;
        
        const adButtonsContainer = modalContent.querySelector('#adButtonsContainer');
        
        for (let i = 0; i < diamondData.ads; i++) {
            const adButton = document.createElement('button');
            adButton.className = 'btn-ad';
            adButton.innerHTML = `<i class="fas fa-play-circle"></i> Start Step (${i + 1}/${diamondData.ads})`;
            adButton.disabled = (i > 0);
            
            adButton.addEventListener('click', () => {
                createVerificationAdFlow(adButton, () => {
                    adButton.innerHTML = `<i class="fas fa-check-circle"></i> Step Complete!`;
                    adButton.classList.add('watched');
                    adButton.disabled = true;
                    adsWatched++;
                    if (adsWatched >= diamondData.ads) {
                        adModal.classList.remove('show');
                        startTopupProcess();
                    } else {
                        const nextButton = adButtonsContainer.querySelectorAll('.btn-ad')[adsWatched];
                        if (nextButton) nextButton.disabled = false;
                    }
                });
            });
            adButtonsContainer.appendChild(adButton);
        }
        
        modalContent.querySelector('#cancelAdProcess').addEventListener('click', () => { adModal.classList.remove('show'); clearVerificationState(); });
        adModal.classList.add('show');
    }
    
    function createVerificationAdFlow(button, onComplete) {
        if (localStorage.getItem('activeTimer')) return;
        const adWindow = window.open(DIRECT_LINK_URL, '_blank');
        const endTime = Date.now() + 10000;
        localStorage.setItem('activeTimer', JSON.stringify({ endTime }));
        
        const checkWindowClosed = setInterval(() => {
            if (!adWindow || adWindow.closed) {
                clearInterval(checkWindowClosed);
                if (Date.now() < endTime) {
                    showToast('Cancelled! You closed the page too early.', 'danger');
                    adModal.classList.remove('show');
                    clearVerificationState();
                }
            }
        }, 500);
        runTimerLoop(button, endTime, onComplete);
    }

    function runTimerLoop(button, endTime, onComplete) {
        if (activeTimerInterval) clearInterval(activeTimerInterval);
        button.disabled = true;
        activeTimerInterval = setInterval(() => {
            const remainingTime = Math.max(0, endTime - Date.now());
            if (remainingTime > 0) {
                button.innerHTML = `<i class="fas fa-hourglass-half"></i> Please Wait ${Math.ceil(remainingTime / 1000)}s...`;
            } else {
                clearInterval(activeTimerInterval);
                activeTimerInterval = null;
                localStorage.removeItem('activeTimer');
                onComplete();
            }
        }, 250);
    }
    
    function handleSpeedUp(index) {
        const history = JSON.parse(localStorage.getItem('topupHistory')) || [];
        const entry = history[index];
        if (!entry || entry.adsWatched >= 3) return;

        modalContent.innerHTML = `
            <h3>Speed Up Top-up</h3>
            <p style="margin: 1rem 0; color: var(--text-light);">Complete a quick step to cut the remaining waiting time in half.</p>
            <button class="btn-ad" id="speedUpAdButton"><i class="fas fa-forward"></i> Start Speed-up Step</button>
            <button class="btn-cancel" id="cancelSpeedUp">Cancel</button>
        `;
        
        modalContent.querySelector('#speedUpAdButton').addEventListener('click', (e) => {
            createVerificationAdFlow(e.currentTarget, () => {
                const currentHistory = JSON.parse(localStorage.getItem('topupHistory')) || [];
                const currentEntry = currentHistory[index];
                if(currentEntry && currentEntry.status === 'pending') {
                    currentEntry.endTime -= (currentEntry.endTime - Date.now()) / 2;
                    currentEntry.adsWatched += 1;
                    localStorage.setItem('topupHistory', JSON.stringify(currentHistory));
                    showToast('Remaining time has been halved!');
                    adModal.classList.remove('show');
                    renderHistory();
                }
            });
        });
        
        modalContent.querySelector('#cancelSpeedUp').addEventListener('click', () => { adModal.classList.remove('show'); clearVerificationState(); });
        adModal.classList.add('show');
    }

    function startTopupProcess() {
        showToast(`Top-up is pending. Please check history.`);
        saveHistory();
        document.getElementById('topupForm').reset();
        countrySelect.value = '';
        populateDiamonds(null);
        topupButton.disabled = true;
    }
    
    function saveHistory() {
        const diamondData = gameData[countrySelect.value]?.diamonds[selectedDiamondIndex];
        const newEntry = {
            uid: playerUidInput.value, package: diamondData.text, date: new Date().toISOString(), status: 'pending', 
            endTime: Date.now() + 3 * 60 * 60 * 1000, adsWatched: 0
        };
        let history = JSON.parse(localStorage.getItem('topupHistory')) || [];
        history.unshift(newEntry);
        localStorage.setItem('topupHistory', JSON.stringify(history.slice(0, 5)));
        renderHistory();
    }

    function renderHistory() {
        const history = JSON.parse(localStorage.getItem('topupHistory')) || [];
        historyCard.style.display = history.length > 0 ? 'block' : 'none';
        historyList.innerHTML = '';
        history.forEach((entry, index) => {
             const listItem = document.createElement('div');
             listItem.className = 'list-item';
             
             let statusSection;
             if(entry.status === 'success') {
                statusSection = `<span class="status-badge success">Success</span>`;
             } else {
                 statusSection = `<div style="text-align: right;">
                    <span class="status-badge pending">Pending</span>
                    <div class="timer-display" data-index="${index}" style="font-size:0.8rem; margin-top: 4px;">${formatTime(entry.endTime - Date.now())}</div>
                    <button class="btn-speed-up" data-index="${index}" ${entry.adsWatched >= 3 ? 'disabled' : ''}>Speed Up (${entry.adsWatched}/3)</button>
                 </div>`;
             }
             listItem.innerHTML = `
                <div>
                    <strong style="display:block;">UID: ${entry.uid}</strong>
                    <span style="color:var(--text-light); font-size: 0.8rem;">${entry.package}</span>
                </div>
                ${statusSection}`;
             historyList.appendChild(listItem);
        });
        historyList.querySelectorAll('.btn-speed-up').forEach(button => {
            button.addEventListener('click', (e) => handleSpeedUp(parseInt(e.currentTarget.dataset.index)));
        });
    }

    function generateLiveTopup() {
        const liveTopupList = document.getElementById('liveTopupList'); 
        const uidStart = Math.floor(1000 + Math.random() * 9000);
        const uidEnd = Math.floor(10 + Math.random() * 90);
        const amounts = ['Weekly', '610 üíé', '115 üíé', 'Monthly', '25 üíé'];
        const listItem = document.createElement('div'); 
        listItem.className = 'list-item'; 
        listItem.innerHTML = `
            <span>UID: ${uidStart}****${uidEnd}</span>
            <div style="display: flex; align-items: center; gap: 0.6rem;">
                <strong style="font-weight: 500;">${amounts[Math.floor(Math.random()*amounts.length)]}</strong>
                <span class="status-badge success">Success</span>
            </div>`;
        liveTopupList.prepend(listItem); 
        if (liveTopupList.children.length > 3) liveTopupList.lastChild.remove(); 
    }
    
    function validateForm() {
        const selectedCountry = countrySelect.value;
        const uid = playerUidInput.value;
        topupButton.disabled = !(selectedCountry && gameData[selectedCountry].validation.test(uid) && selectedDiamondIndex !== null);
    }

    function showToast(message, type = 'normal') {
        const toast = document.getElementById('success-toast');
        toast.textContent = message;
        toast.style.backgroundColor = type === 'danger' ? 'var(--danger-color)' : '#333';
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 4000);
    }

    function formatTime(ms) {
        if (ms < 0) return '00:00:00';
        const h = String(Math.floor(ms / 3600000)).padStart(2, '0');
        const m = String(Math.floor((ms % 3600000) / 60000)).padStart(2, '0');
        const s = String(Math.floor((ms % 60000) / 1000)).padStart(2, '0');
        return `${h}:${m}:${s}`;
    }

    function updateAllTimers() {
        let needsRender = false;
        const history = JSON.parse(localStorage.getItem('topupHistory')) || [];
        history.forEach((entry, index) => {
            if (entry.status === 'pending' && entry.endTime - Date.now() < 1000) {
                entry.status = 'success';
                needsRender = true;
            }
        });
        if (needsRender) {
            localStorage.setItem('topupHistory', JSON.stringify(history));
            renderHistory();
        } else {
             document.querySelectorAll('.timer-display').forEach(el => {
                const entry = history[el.dataset.index];
                if (entry) el.textContent = formatTime(entry.endTime - Date.now());
             });
        }
    }
    
    function clearVerificationState() {
        localStorage.removeItem('activeTimer');
        if(activeTimerInterval) clearInterval(activeTimerInterval);
        activeTimerInterval = null;
    }

    // --- EVENT LISTENERS ---
    countrySelect.addEventListener('change', () => {
        populateDiamonds(gameData[countrySelect.value]?.diamonds);
        validateForm();
    });
    playerUidInput.addEventListener('input', validateForm);
    topupButton.addEventListener('click', showVerificationModal);
    
    infoCardHeader.addEventListener('click', () => {
        const isHidden = infoCardBody.style.display === 'none' || infoCardBody.style.display === '';
        infoCardBody.style.display = isHidden ? 'block' : 'none';
        infoIcon.style.transform = isHidden ? 'rotate(180deg)' : 'rotate(0deg)';
    });

    menuTrigger.addEventListener('click', () => {
        menuModal.classList.add('show');
    });

    menuModal.addEventListener('click', (event) => {
        if (event.target === menuModal) {
            menuModal.classList.remove('show');
        }
    });
    
    document.querySelectorAll('.menu-link').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault(); 
            const targetId = e.currentTarget.dataset.target;
            const targetElement = document.getElementById(targetId);

            if (targetElement) {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
                targetElement.style.display = 'block';
            } else {
                showToast('This page is coming soon!');
            }
            menuModal.classList.remove('show');
        });
    });

    // --- INITIALIZATION ---
    populateCountries();
    renderHistory();
    setInterval(generateLiveTopup, 4500);
    setInterval(updateAllTimers, 1000);
});
</script>
</body>
</html>